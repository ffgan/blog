# 加密

## 0. 前言

最近在上一个量子计算的课，要写一篇报告，有关量子算法或者量子编程或者参加相关比赛，报告截止时间比较微妙，打比赛的途径是指望不上了。那就自然而然选个量子算法介绍一下就差不多了。

不过依我所知，我一无所知。通过翻阅课件可知，课程里提到了几个算法，shor、grover、Deutsch Algorithm等。那这下真是触发关键字了，大名鼎鼎的秀尔算法，**有望**能干翻现有的什么RSA、ED25519等非对称加密算法。美国国家标准与技术研究院 (NIST)为了抵抗这个威胁，推出了[PQC](https://zh.wikipedia.org/wiki/%E5%90%8E%E9%87%8F%E5%AD%90%E5%AF%86%E7%A0%81%E5%AD%A6)（Post-quantum cryptography，后量子密码学）标准，给出了三个标准算法。

正好，密码学这块我也一直觉得挺有意思的，就顺便把琢磨过程写出来，以供后来者参考。本篇blog内容会比较散，大概围绕密码学介绍一下相关的内容。

以下按照惯例先回答几个我感觉可能会被问到的问题。

### 1. 哪听说到的shor算法，在上量子计算课之前？

有个b站up主，[硬件茶谈](https://space.bilibili.com/14871346)，之前爱看他的装机视频，后来出了一期加密有关的[视频](https://www.bilibili.com/video/BV1Eo4y1y7Dh/)，里面提及了shor算法。

### 2. 之前了解过多少的密码学有关知识？

这个话题就比较大了。我本身不是干信安的，密码学了解不多。只是在一门公开课上听过一些对称加密、非对称加密、公私钥、签名验签、证书之类的。后续阴差阳错又琢磨了一段时间的密码学，了解了比如说轮换、置换等用来加密，杂凑、HMAC、加盐、SHA系列、md系列等哈希相关的名词，对称加密里又听说过DES、3DES、AES等，在非对称加密里就有RSA、ECC、ECDSA、D-H交换、ED25519、DSA等，以及国产的一些sm系列算法。仅限于听说过这些名词，知道大概能干嘛的。相关的库听过比如openssl、boring ssl，这个boring ssl从quic协议那边听来的，说openssl支持缓慢，要装这个boring ssl才能用quic。还听过一些就是TLS1.3淘汰了一些比如md5、RSA等。

再有就是看过一点点点点的openssl里面的源码，在c看到了有一堆的函数指针、上千行的函数，小小的震撼了只会hello world的我。

### 3. 为什么对密码学感兴趣？

最早觉得比较神奇的是SSH的密钥登陆，不用输入密码来登陆，而且安全性比我记住的哪怕是几十位密码都要高，背后的巧妙原理正是非对称加密。

2022年Apple推出来的passkey通行密钥能实现免密登陆，旨在加速淘汰传统的密码登陆，这里同样是非对称加密在背后支撑。

这些应用场景很难不让人对其背后的原理感兴趣。

## 1. 加密

指望通过本篇blog来学习密码学是不可能的。更加正确的做法应该是去寻找相关的专业课程学习。

本篇blog仅仅只是我自己对于密码学的一些见解与看法

在信息安全这边有个词特别出名，不安全的信道，也就是传输信息的通道是不安全的，从这条通道传输的数据都存在被监听的可能。

被监听肯定是不合适的，那我们就要想一种办法来保护我们要传输的数据。于是乎就有了两个专有名词，明文（待传达给对方的信息或者数据，但不能直接传输明文，因为会被监听到，信息也就泄露了），密文（可以直接在不安全的信道上传输的数据，对明文加密而得到密文）。密文需要满足一个条件，一定要能够还原得到明文，如果无法还原得到明文，那这个加密就是无效的。亦即对密文解密能够得到明文。

于是乎，我们可以来看看hash算法能否用来当作加密算法，比如说使用常见的md5，现在我把linux源码给hash了，得到一个16字节的哈希值，然后把哈希值当作密文传输给对方。如果有人能从这16个字节中**解密**得到linux源码，那这个技术是相当颠覆性的存在。其实这里背后藏着一个概念，信息，信息是对不确定性的消除。所谓信息量大，也就是说这个信息承载的数据量大。那么显然，hash的过程发生了信息丢失。16字节的哈希值是无法承载linux源码所需要表示出来的信息。那这个16字节的哈希值表示了什么？linux源码的哈希值。如果linux源码中有了一些修改，重新对其使用md5计算，就可以得到一个新的哈希值。

那么现在再来看看各种**编码形式**，比如说ASCII编码，用数字来表示字母。那么假设用来当作加密算法，也就是从明文的字符串转换为数字来传输

```python
>>> [ord(i) for i in "Hello World!"]
[72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33]
```

我在纸上写的不是"Hello World!"，而是 [72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33]，然后传输这个纸条给目标对象。这显然没有保密，因为只需要拥有ASCII表即可快速解密。所以那些各式各样的编码格式，只不过是换了一种**众人都知道的**编码与解码格式的数据表现形式。将信息转换为不同形式是为了方便传输数据或者实现其他的目的。

比如ASCII是为了解决计算机只认识0101,而不认识字符的问题而发明出来的。

又比如BASE64编码格式，发明出来就是为了用文本形式来表示二进制数据。有些协议只支持传输文本形式的数据，比如电子邮件中把二进制形式的文件用文本形式的字符串表示出来，这样就能够**兼容** *历史遗留*。有一个比较有意思的场景，如果图片比较小，可以不使用外链的形式，直接把这个图片的base64编码形式贴出来也可以当作图片来显示。亦即二者表现形式是等价的。不同格式就是为了面向不同场景而诞生的，其所表示的内容都是同一个内容。（编码格式的内容在后面还会提及）

经过BASE64编码的字符串体积会上涨。如果都是二进制形式的传输就没有必要再编码一层，无意义的套娃操作，直接传输二进制数据就完事了。

现在终于可以来看看加密了。将明文加密为密文，密文在适当的解密算法下可以解密得到明文。那么，是否就可以把密文当作明文的一种特殊表示形式，只不过这种形式只有特定的解密操作才能够将密文转换回来得到明文。如果从这个角度来看待编码格式，那么上面所提及的ascii编码、base64编码，以及未提及但是也很出名的摩尔斯电码，都是*没有加密作用*的编码，因为人人都知道如何*解密*。不过为了方便起见，我们一般还是默认编码操作不会起加密作用，而把加密这种特殊的*编码形式*专门称为加密。这样的话，就比较容易区分二者了。

那么在加密这个操作里，其实可以分为两部分，一个是加密算法，一个是加密密钥。为啥要区分开来这两个呢？




## -1. 一些有用的参考链接

1. [Google Cloud对于加密的介绍](https://cloud.google.com/learn/what-is-encryption?hl=zh-CN)
2. [Wikipedia对于密码学的介绍](https://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6)
3. [ctf-wiki对于密码学的介绍](https://ctf-wiki.org/crypto/introduction/)
4. [cloudflare对于加密的介绍](https://www.cloudflare-cn.com/learning/ssl/what-is-encryption/)
